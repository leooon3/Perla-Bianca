<!DOCTYPE html>
<html lang="it">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Area Riservata · I Sarcofagi del Re</title>

    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,400;0,600;0,700;1,400&family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet" />

    <link rel="stylesheet" href="style.css" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css" />
    <link rel="icon" href="./img/logo.ico" type="image/ico" />

    <script src="https://accounts.google.com/gsi/client" async defer></script>
    <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
    <script src="https://npmcdn.com/flatpickr/dist/l10n/it.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.15/index.global.min.js"></script>

    <style>
      :root {
        --navy:          #1B3A5C;
        --navy-light:    #244b73;
        --navy-dark:     #0d2135;
        --terracotta:    #C4622D;
        --terracotta-lt: #d4784a;
        --ivory:         #FAF8F4;
        --ivory-dark:    #F0EBE3;
        --border:        #E8E0D4;
      }

      *, *::before, *::after { box-sizing: border-box; }

      body {
        margin: 0;
        font-family: 'Inter', sans-serif;
        background: var(--ivory);
        color: #333;
      }

      .font-display { font-family: 'Playfair Display', serif; }

      /* ── Login Screen ── */
      #loginScreen {
        position: fixed;
        inset: 0;
        z-index: 50;
        display: flex;
        align-items: center;
        justify-content: center;
        padding: 1.5rem;
        background: linear-gradient(135deg, var(--navy) 0%, var(--navy-dark) 100%);
      }
      #loginScreen.hidden { display: none; }

      .login-card {
        width: 100%;
        max-width: 420px;
        background: var(--ivory);
        border-radius: 24px;
        box-shadow: 0 40px 100px rgba(0,0,0,0.45);
        padding: 3rem 2.5rem;
      }
      .login-logo-wrap {
        text-align: center;
        margin-bottom: 2.25rem;
      }
      .login-logo-wrap img {
        height: 52px;
        width: auto;
        margin-bottom: 1.25rem;
      }
      .login-title {
        font-family: 'Playfair Display', serif;
        font-size: 1.7rem;
        color: var(--navy);
        margin: 0 0 0.35rem;
      }
      .login-subtitle {
        font-size: 0.72rem;
        letter-spacing: 0.2em;
        text-transform: uppercase;
        color: #aaa;
        margin: 0;
      }

      .login-divider {
        display: flex;
        align-items: center;
        gap: 1rem;
        margin: 1.5rem 0;
      }
      .login-divider-line {
        flex: 1;
        height: 1px;
        background: var(--border);
      }
      .login-divider-text {
        font-size: 0.68rem;
        letter-spacing: 0.2em;
        text-transform: uppercase;
        color: #c8bfb2;
        white-space: nowrap;
      }

      .login-input {
        width: 100%;
        padding: 0.875rem 1.1rem;
        border: 1.5px solid var(--border);
        border-radius: 10px;
        background: white;
        font-family: 'Inter', sans-serif;
        font-size: 0.9rem;
        color: #333;
        outline: none;
        transition: border-color 0.25s, box-shadow 0.25s;
        display: block;
      }
      .login-input:focus {
        border-color: var(--navy);
        box-shadow: 0 0 0 3px rgba(27,58,92,0.1);
      }
      .login-input-otp {
        text-align: center;
        font-size: 2rem;
        letter-spacing: 0.35em;
        font-weight: 600;
      }

      .login-btn {
        display: block;
        width: 100%;
        margin-top: 0.75rem;
        padding: 0.9rem;
        border: none;
        border-radius: 10px;
        font-family: 'Inter', sans-serif;
        font-size: 0.875rem;
        font-weight: 700;
        letter-spacing: 0.06em;
        cursor: pointer;
        transition: background 0.25s, transform 0.2s;
      }
      .login-btn:active { transform: scale(0.98); }
      .login-btn-navy {
        background: var(--navy);
        color: white;
      }
      .login-btn-navy:hover { background: var(--navy-light); }
      .login-btn-terra {
        background: var(--terracotta);
        color: white;
      }
      .login-btn-terra:hover { background: var(--terracotta-lt); }
      .login-btn-link {
        display: block;
        width: 100%;
        background: none;
        border: none;
        margin-top: 0.875rem;
        font-size: 0.8rem;
        color: #b0a89e;
        text-decoration: underline;
        cursor: pointer;
        font-family: 'Inter', sans-serif;
        text-align: center;
      }

      .login-step2-hint {
        font-size: 0.84rem;
        color: #777;
        text-align: center;
        margin-bottom: 0.875rem;
        line-height: 1.5;
      }

      #errorMsg {
        margin-top: 1rem;
        font-size: 0.84rem;
        color: #c0392b;
        text-align: center;
        min-height: 1.2em;
      }
      #errorMsg.hidden { display: none; }

      /* ── Dashboard ── */
      #dashboard { min-height: 100vh; background: var(--ivory); }
      #dashboard.hidden { display: none; }

      /* ── Dashboard Header ── */
      .dash-header {
        background: var(--navy);
        padding: 1.1rem 2rem;
        display: flex;
        align-items: center;
        justify-content: space-between;
        box-shadow: 0 4px 24px rgba(27,58,92,0.25);
        position: sticky;
        top: 0;
        z-index: 40;
      }
      .dash-header-logo {
        display: flex;
        align-items: center;
        gap: 0.875rem;
        text-decoration: none;
      }
      .dash-header-logo img { height: 36px; width: auto; }
      .dash-header-title {
        font-family: 'Playfair Display', serif;
        font-size: 1.2rem;
        font-weight: 700;
        color: #fff;
        line-height: 1.1;
      }
      .dash-header-sub {
        font-size: 0.6rem;
        letter-spacing: 0.22em;
        text-transform: uppercase;
        color: rgba(255,255,255,0.38);
      }
      .dash-logout-btn {
        background: transparent;
        border: 1.5px solid rgba(196,98,45,0.45);
        color: #e8a080;
        padding: 0.45rem 1.1rem;
        border-radius: 8px;
        font-family: 'Inter', sans-serif;
        font-size: 0.78rem;
        font-weight: 700;
        letter-spacing: 0.05em;
        cursor: pointer;
        transition: background 0.25s, border-color 0.25s;
      }
      .dash-logout-btn:hover {
        background: rgba(196,98,45,0.14);
        border-color: rgba(196,98,45,0.7);
      }

      /* ── Dashboard Body ── */
      .dash-body {
        max-width: 1100px;
        margin: 0 auto;
        padding: 2.5rem 1.5rem 4rem;
      }

      /* ── Section Header ── */
      .dash-section-head {
        margin-bottom: 1.5rem;
      }
      .dash-section-title {
        font-family: 'Playfair Display', serif;
        font-size: 1.45rem;
        color: var(--navy);
        margin: 0 0 0.2rem;
      }
      .dash-section-sub {
        font-size: 0.68rem;
        letter-spacing: 0.22em;
        text-transform: uppercase;
        color: #bbb;
        margin: 0;
      }

      /* ── Property Tabs Card ── */
      .dash-tabs-card {
        background: white;
        border-radius: 16px;
        box-shadow: 0 2px 20px rgba(0,0,0,0.06);
        overflow: hidden;
        border: 1px solid var(--border);
      }
      .dash-tab-nav {
        display: flex;
        border-bottom: 1.5px solid var(--ivory-dark);
      }
      .dash-tab-content {
        padding: 1.75rem;
      }
    </style>
  </head>

  <body>

    <!-- ════════════════════════════════
         LOGIN SCREEN
    ════════════════════════════════ -->
    <div id="loginScreen">
      <div class="login-card">

        <!-- Logo + Title -->
        <div class="login-logo-wrap">
          <img src="img/logo+text.png" alt="I Sarcofagi del Re" />
          <h1 class="login-title">Area Riservata</h1>
          <p class="login-subtitle">Pannello di gestione</p>
        </div>

        <!-- Google Button -->
        <div id="googleBtnContainer" style="display:flex; justify-content:center; height:44px; margin-bottom:1.25rem;"></div>

        <!-- Divider -->
        <div class="login-divider">
          <div class="login-divider-line"></div>
          <span class="login-divider-text">Oppure email</span>
          <div class="login-divider-line"></div>
        </div>

        <!-- Email Auth Form -->
        <form id="emailAuthForm">
          <!-- Step 1: email -->
          <div id="step1">
            <input
              type="email"
              id="emailInput"
              class="login-input"
              placeholder="tua@email.com"
              autocomplete="email"
              required
            />
            <button type="submit" class="login-btn login-btn-navy">
              Ricevi Codice
            </button>
          </div>

          <!-- Step 2: OTP -->
          <div id="step2" class="hidden">
            <p class="login-step2-hint">Inserisci il codice ricevuto via mail:</p>
            <input
              type="text"
              id="otpInput"
              class="login-input login-input-otp"
              placeholder="123456"
              maxlength="6"
              inputmode="numeric"
            />
            <button type="button" id="verifyBtn" class="login-btn login-btn-terra">
              Accedi
            </button>
            <button type="button" id="backBtn" class="login-btn-link">
              Cambia indirizzo mail
            </button>
          </div>
        </form>

        <p id="errorMsg" class="hidden"></p>
      </div>
    </div>


    <!-- ════════════════════════════════
         DASHBOARD
    ════════════════════════════════ -->
    <div id="dashboard" class="hidden">

      <!-- Header -->
      <header class="dash-header">
        <a href="/" class="dash-header-logo">
          <img src="img/logo.png" alt="Logo" />
          <div>
            <div class="dash-header-title">I Sarcofagi del Re</div>
            <div class="dash-header-sub">Pannello di controllo</div>
          </div>
        </a>
        <button id="logoutBtn" class="dash-logout-btn">Esci</button>
      </header>

      <!-- Body -->
      <div class="dash-body">

        <!-- Overview -->
        <section style="margin-bottom: 2.5rem;">
          <div class="dash-section-head">
            <h2 class="dash-section-title">Panoramica</h2>
            <p class="dash-section-sub">Stato delle strutture</p>
          </div>
          <div id="overviewGrid" class="grid sm:grid-cols-2 gap-4">
            <!-- Populated by JS -->
          </div>
        </section>

        <!-- Property Tabs -->
        <div class="dash-tabs-card">
          <div class="dash-tab-nav" id="tabNav">
            <!-- Populated by JS -->
          </div>
          <div class="dash-tab-content" id="tabContent">
            <!-- Populated by JS -->
          </div>
        </div>

      </div>
    </div>

    <script src="js/admin.js"></script>
  </body>
</html>
