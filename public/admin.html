<!DOCTYPE html>
<html lang="it">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Area Riservata · I Sarcofagi del Re</title>

    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,400;0,600;0,700;1,400&family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet" />

    <link rel="stylesheet" href="style.css" />
    <link rel="stylesheet" href="css/admin.css" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css" />
    <link rel="icon" href="./img/logo.ico" type="image/ico" />

    <script src="https://accounts.google.com/gsi/client" async defer></script>
    <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
    <script src="https://npmcdn.com/flatpickr/dist/l10n/it.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.15/index.global.min.js"></script>
  </head>

  <body>

    <!-- ════════════════════════════════
         LOGIN SCREEN
    ════════════════════════════════ -->
    <div id="loginScreen">
      <div class="login-card">
        <div class="login-logo">
          <img src="img/logo+text.png" alt="I Sarcofagi del Re" />
          <h1>Area Riservata</h1>
          <p>Pannello di gestione</p>
        </div>

        <div id="googleBtnContainer" style="display:flex; justify-content:center; height:44px; margin-bottom:1rem;"></div>

        <div class="login-divider"><span>Oppure email</span></div>

        <form id="emailAuthForm">
          <div id="step1">
            <input type="email" id="emailInput" class="login-input" placeholder="tua@email.com" autocomplete="email" required />
            <button type="submit" class="lbtn lbtn-navy">Ricevi Codice</button>
          </div>
          <div id="step2" class="hidden">
            <p class="otp-hint">Inserisci il codice ricevuto via mail:</p>
            <input type="text" id="otpInput" class="login-input otp-input" placeholder="123456" maxlength="6" inputmode="numeric" />
            <button type="button" id="verifyBtn" class="lbtn lbtn-terra">Accedi</button>
            <button type="button" id="backBtn" class="lbtn-link">Cambia indirizzo mail</button>
          </div>
        </form>

        <p id="errorMsg" class="hidden"></p>
      </div>
    </div>


    <!-- ════════════════════════════════
         DASHBOARD
    ════════════════════════════════ -->
    <div id="dashboard" class="hidden" style="min-height:100vh; display:flex; flex-direction:column;">

      <!-- Top Nav -->
      <nav class="top-nav">
        <a href="/" class="nav-logo">
          <img src="img/logo.png" alt="Logo" />
          <div>
            <div class="nav-logo-name">I Sarcofagi del Re</div>
            <div class="nav-logo-sub">Pannello di controllo</div>
          </div>
        </a>

        <div class="nav-sections">
          <button class="nav-sec-btn active" id="navBtnCalendario" data-section="calendario" onclick="app.showSection('calendario')">
            Calendario
            <span class="nav-badge hidden" id="badgeCal">0</span>
          </button>
          <button class="nav-sec-btn" id="navBtnRecensioni" data-section="recensioni" onclick="app.showSection('recensioni')">
            Recensioni
            <span class="nav-badge hidden" id="badgeRev">0</span>
          </button>
        </div>

        <div class="nav-right">
          <div class="prop-wrap" id="propWrap">
            <button class="prop-btn" id="propBtn" onclick="app.togglePropMenu()">
              <span id="propLabel">Perla Bianca</span>
              <svg viewBox="0 0 12 12" fill="none" stroke="currentColor" stroke-width="2.5">
                <polyline points="2,4 6,8 10,4"/>
              </svg>
            </button>
            <div class="prop-menu hidden" id="propMenu"></div>
          </div>
          <button id="logoutBtn" class="logout-btn">Esci</button>
        </div>
      </nav>

      <!-- Main -->
      <main class="main" style="flex:1;">

        <!-- ── CALENDARIO ── -->
        <section id="sectionCalendario" class="section active">
          <div class="sec-hd">
            <div>
              <h2 class="sec-title">Calendario</h2>
              <p class="sec-sub">Clicca su un giorno per aggiungere una prenotazione</p>
            </div>
            <button class="btn-add" onclick="app.openAddModal()">
              + Nuova prenotazione
            </button>
          </div>
          <div id="calendarEl"></div>
        </section>

        <!-- ── RECENSIONI ── -->
        <section id="sectionRecensioni" class="section">
          <div class="sec-hd">
            <div>
              <h2 class="sec-title">Recensioni</h2>
            </div>
          </div>
          <div class="rev-tabs">
            <button class="rev-tab active" id="revTabAttesa" onclick="app.switchReviewTab('attesa')">
              In attesa
              <span class="rev-count zero" id="countAttesa">0</span>
            </button>
            <button class="rev-tab" id="revTabPubbliche" onclick="app.switchReviewTab('pubblicate')">
              Pubblicate
            </button>
          </div>
          <div id="reviewsList" class="reviews-list"></div>
        </section>

      </main>
    </div>


    <!-- ════════════════════════════════
         MODAL: Aggiungi prenotazione
    ════════════════════════════════ -->
    <div id="addModal" class="modal hidden">
      <div class="modal-card" id="addModalCard">
        <div class="modal-hd">
          <h3 class="modal-title">Nuova prenotazione</h3>
          <button class="modal-close" onclick="app.closeAddModal()">×</button>
        </div>
        <form id="addEventForm">
          <div class="form-check">
            <input type="checkbox" id="isBlockedDate" />
            <label for="isBlockedDate">Chiuso / Manutenzione</label>
          </div>
          <div class="form-group">
            <label class="form-label" for="eventName">Nome ospite</label>
            <input type="text" id="eventName" class="form-field" placeholder="Es. Mario Rossi" required />
          </div>
          <div class="form-group">
            <label class="form-label" for="eventDates">Date</label>
            <input type="text" id="eventDates" class="form-field" placeholder="Seleziona date..." readonly />
          </div>
          <div class="form-group">
            <label class="form-label" for="eventNotes">Note interne</label>
            <textarea id="eventNotes" class="form-field form-textarea" placeholder="Pagamento, telefono..."></textarea>
          </div>
          <button type="submit" class="btn-submit">Salva prenotazione</button>
        </form>
      </div>
    </div>


    <!-- ════════════════════════════════
         MODAL: Dettaglio evento
    ════════════════════════════════ -->
    <div id="eventModal" class="modal hidden">
      <div class="modal-card" id="eventModalCard">
        <div id="eventModalContent"></div>
      </div>
    </div>


    <script src="js/admin.js"></script>
  </body>
</html>
